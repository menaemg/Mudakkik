; Supervisor configuration for Mudakkik - Laravel Horizon & Reverb
; Copy to: /etc/supervisor/conf.d/mudakkik.conf
;
; Horizon manages all queue workers with:
; - Auto-scaling based on load
; - Real-time dashboard at /horizon
; - Job metrics and failure tracking
;
; Reverb provides WebSocket server for:
; - Real-time notifications via broadcast
; - Private/presence channel authentication
;
; Scheduled Jobs (handled by cron, not supervisor):
; - ReconcilePendingPayments: Every 10 minutes
; - HandleExpiredSubscriptions: Daily at midnight

[program:mudakkik-horizon]
process_name=%(program_name)s
command=php /var/www/mudakkik/current/artisan horizon
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
user=ubuntu
numprocs=1
redirect_stderr=true
stdout_logfile=/var/www/mudakkik/shared/storage/logs/horizon.log
stopwaitsecs=3600

[program:mudakkik-reverb]
process_name=%(program_name)s
command=php /var/www/mudakkik/current/artisan reverb:start --host=0.0.0.0 --port=8080
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
user=ubuntu
numprocs=1
redirect_stderr=true
stdout_logfile=/var/www/mudakkik/shared/storage/logs/reverb.log
stopwaitsecs=10
